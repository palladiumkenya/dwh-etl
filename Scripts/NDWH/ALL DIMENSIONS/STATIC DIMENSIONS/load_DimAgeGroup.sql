IF OBJECT_ID(N'NDWH.dbo.DimAgeGroup', N'U') IS NOT NULL 
	DROP TABLE  NDWH.dbo.DimAgeGroup;
BEGIN
	with source_agegroup as (
    select 0 as Age,  ' Under 1' as MOHAgeGroup,   ' Under 1' as DATIMAgeGroup  union all 
    select 1 as Age,  '01 to 09' as MOHAgeGroup,   '01 to 04' as DATIMAgeGroup  union all 
    select 2 as Age,  '01 to 09' as MOHAgeGroup,   '01 to 04' as DATIMAgeGroup  union all 
    select 3 as Age,  '01 to 09' as MOHAgeGroup,   '01 to 04' as DATIMAgeGroup  union all 
    select 4 as Age,  '01 to 09' as MOHAgeGroup,   '01 to 04' as DATIMAgeGroup  union all 
    select 5 as Age,  '01 to 09' as MOHAgeGroup,   '05 to 09' as DATIMAgeGroup  union all 
    select 6 as Age,  '01 to 09' as MOHAgeGroup,   '05 to 09' as DATIMAgeGroup  union all 
    select 7 as Age,  '01 to 09' as MOHAgeGroup,   '05 to 09' as DATIMAgeGroup  union all 
    select 8 as Age,  '01 to 09' as MOHAgeGroup,   '05 to 09' as DATIMAgeGroup  union all 
    select 9 as Age,  '01 to 09' as MOHAgeGroup,   '05 to 09' as DATIMAgeGroup  union all 
    select 10 as Age,  '10 to 14' as MOHAgeGroup,   '10 to 14' as DATIMAgeGroup  union all 
    select 11 as Age,  '10 to 14' as MOHAgeGroup,   '10 to 14' as DATIMAgeGroup  union all 
    select 12 as Age,  '10 to 14' as MOHAgeGroup,   '10 to 14' as DATIMAgeGroup  union all 
    select 13 as Age,  '10 to 14' as MOHAgeGroup,   '10 to 14' as DATIMAgeGroup  union all 
    select 14 as Age,  '10 to 14' as MOHAgeGroup,   '10 to 14' as DATIMAgeGroup  union all 
    select 15 as Age,  '15 to 19' as MOHAgeGroup,   '15 to 19' as DATIMAgeGroup  union all 
    select 16 as Age,  '15 to 19' as MOHAgeGroup,   '15 to 19' as DATIMAgeGroup  union all 
    select 17 as Age,  '15 to 19' as MOHAgeGroup,   '15 to 19' as DATIMAgeGroup  union all 
    select 18 as Age,  '15 to 19' as MOHAgeGroup,   '15 to 19' as DATIMAgeGroup  union all 
    select 19 as Age,  '15 to 19' as MOHAgeGroup,   '15 to 19' as DATIMAgeGroup  union all 
    select 20 as Age,  '20 to 24' as MOHAgeGroup,   '20 to 24' as DATIMAgeGroup  union all 
    select 21 as Age,  '20 to 24' as MOHAgeGroup,   '20 to 24' as DATIMAgeGroup  union all 
    select 22 as Age,  '20 to 24' as MOHAgeGroup,   '20 to 24' as DATIMAgeGroup  union all 
    select 23 as Age,  '20 to 24' as MOHAgeGroup,   '20 to 24' as DATIMAgeGroup  union all 
    select 24 as Age,  '20 to 24' as MOHAgeGroup,   '20 to 24' as DATIMAgeGroup  union all 
    select 25 as Age,  '25+' as MOHAgeGroup,   '25 to 29' as DATIMAgeGroup  union all 
    select 26 as Age,  '25+' as MOHAgeGroup,   '25 to 29' as DATIMAgeGroup  union all 
    select 27 as Age,  '25+' as MOHAgeGroup,   '25 to 29' as DATIMAgeGroup  union all 
    select 28 as Age,  '25+' as MOHAgeGroup,   '25 to 29' as DATIMAgeGroup  union all 
    select 29 as Age,  '25+' as MOHAgeGroup,   '25 to 29' as DATIMAgeGroup  union all 
    select 30 as Age,  '25+' as MOHAgeGroup,   '30 to 34' as DATIMAgeGroup  union all 
    select 31 as Age,  '25+' as MOHAgeGroup,   '30 to 34' as DATIMAgeGroup  union all 
    select 32 as Age,  '25+' as MOHAgeGroup,   '30 to 34' as DATIMAgeGroup  union all 
    select 33 as Age,  '25+' as MOHAgeGroup,   '30 to 34' as DATIMAgeGroup  union all 
    select 34 as Age,  '25+' as MOHAgeGroup,   '30 to 34' as DATIMAgeGroup  union all 
    select 35 as Age,  '25+' as MOHAgeGroup,   '35 to 39' as DATIMAgeGroup  union all 
    select 36 as Age,  '25+' as MOHAgeGroup,   '35 to 39' as DATIMAgeGroup  union all 
    select 37 as Age,  '25+' as MOHAgeGroup,   '35 to 39' as DATIMAgeGroup  union all 
    select 38 as Age,  '25+' as MOHAgeGroup,   '35 to 39' as DATIMAgeGroup  union all 
    select 39 as Age,  '25+' as MOHAgeGroup,   '35 to 39' as DATIMAgeGroup  union all 
    select 40 as Age,  '25+' as MOHAgeGroup,   '40 to 44' as DATIMAgeGroup  union all 
    select 41 as Age,  '25+' as MOHAgeGroup,   '40 to 44' as DATIMAgeGroup  union all 
    select 42 as Age,  '25+' as MOHAgeGroup,   '40 to 44' as DATIMAgeGroup  union all 
    select 43 as Age,  '25+' as MOHAgeGroup,   '40 to 44' as DATIMAgeGroup  union all 
    select 44 as Age,  '25+' as MOHAgeGroup,   '40 to 44' as DATIMAgeGroup  union all 
    select 45 as Age,  '25+' as MOHAgeGroup,   '45 to 49' as DATIMAgeGroup  union all 
    select 46 as Age,  '25+' as MOHAgeGroup,   '45 to 49' as DATIMAgeGroup  union all 
    select 47 as Age,  '25+' as MOHAgeGroup,   '45 to 49' as DATIMAgeGroup  union all 
    select 48 as Age,  '25+' as MOHAgeGroup,   '45 to 49' as DATIMAgeGroup  union all 
    select 49 as Age,  '25+' as MOHAgeGroup,   '45 to 49' as DATIMAgeGroup  union all 
    select 50 as Age,  '25+' as MOHAgeGroup,   '50 to 54' as DATIMAgeGroup  union all 
    select 51 as Age,  '25+' as MOHAgeGroup,   '50 to 54' as DATIMAgeGroup  union all 
    select 52 as Age,  '25+' as MOHAgeGroup,   '50 to 54' as DATIMAgeGroup  union all 
    select 53 as Age,  '25+' as MOHAgeGroup,   '50 to 54' as DATIMAgeGroup  union all 
    select 54 as Age,  '25+' as MOHAgeGroup,   '50 to 54' as DATIMAgeGroup  union all 
    select 55 as Age,  '25+' as MOHAgeGroup,   '55 to 59' as DATIMAgeGroup  union all 
    select 56 as Age,  '25+' as MOHAgeGroup,   '55 to 59' as DATIMAgeGroup  union all 
    select 57 as Age,  '25+' as MOHAgeGroup,   '55 to 59' as DATIMAgeGroup  union all 
    select 58 as Age,  '25+' as MOHAgeGroup,   '55 to 59' as DATIMAgeGroup  union all 
    select 59 as Age,  '25+' as MOHAgeGroup,   '55 to 59' as DATIMAgeGroup  union all 
    select 60 as Age,  '25+' as MOHAgeGroup,   '60 to 64' as DATIMAgeGroup  union all 
    select 61 as Age,  '25+' as MOHAgeGroup,   '60 to 64' as DATIMAgeGroup  union all 
    select 62 as Age,  '25+' as MOHAgeGroup,   '60 to 64' as DATIMAgeGroup  union all 
    select 63 as Age,  '25+' as MOHAgeGroup,   '60 to 64' as DATIMAgeGroup  union all 
    select 64 as Age,  '25+' as MOHAgeGroup,   '60 to 64' as DATIMAgeGroup  union all 
    select 65 as Age,  '25+' as MOHAgeGroup,   '65+' as DATIMAgeGroup  union all 
    select 66 as Age,  '25+' as MOHAgeGroup,   '65+' as DATIMAgeGroup  union all 
    select 67 as Age,  '25+' as MOHAgeGroup,   '65+' as DATIMAgeGroup  union all 
    select 68 as Age,  '25+' as MOHAgeGroup,   '65+' as DATIMAgeGroup  union all 
    select 69 as Age,  '25+' as MOHAgeGroup,   '65+' as DATIMAgeGroup  union all 
    select 70 as Age,  '25+' as MOHAgeGroup,   '65+' as DATIMAgeGroup  union all 
    select 71 as Age,  '25+' as MOHAgeGroup,   '65+' as DATIMAgeGroup  union all 
    select 72 as Age,  '25+' as MOHAgeGroup,   '65+' as DATIMAgeGroup  union all 
    select 73 as Age,  '25+' as MOHAgeGroup,   '65+' as DATIMAgeGroup  union all 
    select 74 as Age,  '25+' as MOHAgeGroup,   '65+' as DATIMAgeGroup  union all 
    select 75 as Age,  '25+' as MOHAgeGroup,   '65+' as DATIMAgeGroup  union all 
    select 76 as Age,  '25+' as MOHAgeGroup,   '65+' as DATIMAgeGroup  union all 
    select 77 as Age,  '25+' as MOHAgeGroup,   '65+' as DATIMAgeGroup  union all 
    select 78 as Age,  '25+' as MOHAgeGroup,   '65+' as DATIMAgeGroup  union all 
    select 79 as Age,  '25+' as MOHAgeGroup,   '65+' as DATIMAgeGroup  union all 
    select 80 as Age,  '25+' as MOHAgeGroup,   '65+' as DATIMAgeGroup  union all 
    select 81 as Age,  '25+' as MOHAgeGroup,   '65+' as DATIMAgeGroup  union all 
    select 82 as Age,  '25+' as MOHAgeGroup,   '65+' as DATIMAgeGroup  union all 
    select 83 as Age,  '25+' as MOHAgeGroup,   '65+' as DATIMAgeGroup  union all 
    select 84 as Age,  '25+' as MOHAgeGroup,   '65+' as DATIMAgeGroup  union all 
    select 85 as Age,  '25+' as MOHAgeGroup,   '65+' as DATIMAgeGroup  union all 
    select 86 as Age,  '25+' as MOHAgeGroup,   '65+' as DATIMAgeGroup  union all 
    select 87 as Age,  '25+' as MOHAgeGroup,   '65+' as DATIMAgeGroup  union all 
    select 88 as Age,  '25+' as MOHAgeGroup,   '65+' as DATIMAgeGroup  union all 
    select 89 as Age,  '25+' as MOHAgeGroup,   '65+' as DATIMAgeGroup  union all 
    select 90 as Age,  '25+' as MOHAgeGroup,   '65+' as DATIMAgeGroup  union all 
    select 91 as Age,  '25+' as MOHAgeGroup,   '65+' as DATIMAgeGroup  union all 
    select 92 as Age,  '25+' as MOHAgeGroup,   '65+' as DATIMAgeGroup  union all 
    select 93 as Age,  '25+' as MOHAgeGroup,   '65+' as DATIMAgeGroup  union all 
    select 94 as Age,  '25+' as MOHAgeGroup,   '65+' as DATIMAgeGroup  union all 
    select 95 as Age,  '25+' as MOHAgeGroup,   '65+' as DATIMAgeGroup  union all 
    select 96 as Age,  '25+' as MOHAgeGroup,   '65+' as DATIMAgeGroup  union all 
    select 97 as Age,  '25+' as MOHAgeGroup,   '65+' as DATIMAgeGroup  union all 
    select 98 as Age,  '25+' as MOHAgeGroup,   '65+' as DATIMAgeGroup  union all 
    select 99 as Age,  '25+' as MOHAgeGroup,   '65+' as DATIMAgeGroup  union all 
    select 100 as Age,  '25+' as MOHAgeGroup,   '65+' as DATIMAgeGroup  union all 
    select 101 as Age,  '25+' as MOHAgeGroup,   '65+' as DATIMAgeGroup  union all 
    select 102 as Age,  '25+' as MOHAgeGroup,   '65+' as DATIMAgeGroup  union all 
    select 103 as Age,  '25+' as MOHAgeGroup,   '65+' as DATIMAgeGroup  union all 
    select 104 as Age,  '25+' as MOHAgeGroup,   '65+' as DATIMAgeGroup  union all 
    select 105 as Age,  '25+' as MOHAgeGroup,   '65+' as DATIMAgeGroup  union all 
    select 106 as Age,  '25+' as MOHAgeGroup,   '65+' as DATIMAgeGroup  union all 
    select 107 as Age,  '25+' as MOHAgeGroup,   '65+' as DATIMAgeGroup  union all 
    select 108 as Age,  '25+' as MOHAgeGroup,   '65+' as DATIMAgeGroup  union all 
    select 109 as Age,  '25+' as MOHAgeGroup,   '65+' as DATIMAgeGroup  union all 
    select 110 as Age,  '25+' as MOHAgeGroup,   '65+' as DATIMAgeGroup  union all 
    select 111 as Age,  '25+' as MOHAgeGroup,   '65+' as DATIMAgeGroup  union all 
    select 112 as Age,  '25+' as MOHAgeGroup,   '65+' as DATIMAgeGroup  union all 
    select 113 as Age,  '25+' as MOHAgeGroup,   '65+' as DATIMAgeGroup  union all 
    select 114 as Age,  '25+' as MOHAgeGroup,   '65+' as DATIMAgeGroup  union all 
    select 115 as Age,  '25+' as MOHAgeGroup,   '65+' as DATIMAgeGroup  union all 
    select 116 as Age,  '25+' as MOHAgeGroup,   '65+' as DATIMAgeGroup  union all 
    select 117 as Age,  '25+' as MOHAgeGroup,   '65+' as DATIMAgeGroup  union all 
    select 118 as Age,  '25+' as MOHAgeGroup,   '65+' as DATIMAgeGroup  union all 
    select 119 as Age,  '25+' as MOHAgeGroup,   '65+' as DATIMAgeGroup  union all 
    select 120 as Age,  '25+' as MOHAgeGroup,   '65+' as DATIMAgeGroup
)
select 
    AgeGroupKey = IDENTITY(INT, 1, 1),
    source_agegroup.*,
    cast(getdate() as date) as LoadDate
into NDWH.dbo.DimAgeGroup
from source_agegroup;

alter table NDWH.dbo.DimAgeGroup add primary key(AgeGroupKey);

--Set Idenitiy insert on
set identity_insert NDWH.dbo.DimAgeGroup on;

-- Insert a row with a specific identity value
insert into NDWH.dbo.DimAgeGroup(AgeGroupKey, Age, MOHAgeGroup, DATIMAgeGroup, LoadDate )
values (-999, -999, 'Missing', 'Missing', cast(getdate() as date));

-- Disable explicit identity value insertion after the operation
set identity_insert NDWH.dbo.DimAgeGroup off;

END